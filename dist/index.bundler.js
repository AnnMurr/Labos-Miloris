(()=>{var t={516:()=>{const t=document.querySelector(".btnUp");window.addEventListener("scroll",(function(){t.style.display=window.scrollY>0?"flex":"none"}))},693:()=>{const t=document.querySelectorAll(".anim-item");function e(){for(const e of t){const t=e,s=t.offsetHeight,a=n(t).top,o=4;let r=window.innerHeight-s/o;s>window.innerHeight&&(r=window.innerHeight-window.innerHeight/o),window.scrollY>a-r&&window.scrollY<a+s?t.classList.add("anim"):t.classList.contains("anim-no-hide")||t.classList.remove("anim")}}function n(t){const e=t.getBoundingClientRect(),n=window.scrollX||document.documentElement.scrollLeft,s=window.scrollY||document.documentElement.scrollTop;return{top:e.top+s,left:e.left+n}}window.addEventListener("scroll",e),setTimeout((()=>{e()}),300)},930:()=>{const t=document.querySelector(".burger"),e=document.querySelector(".submenu"),n=document.querySelector(".cross");function s(a){e.contains(a.target)||n.contains(a.target)||t.contains(a.target)||(e.classList.remove("submenu_active"),document.removeEventListener("click",s))}t.addEventListener("click",(function(){e.classList.contains("submenu_active")?(e.classList.remove("submenu_active"),document.removeEventListener("click",s)):(e.classList.add("submenu_active"),document.addEventListener("click",s))})),n.addEventListener("click",(()=>e.classList.remove("submenu_active")))}},e={};function n(s){var a=e[s];if(void 0!==a)return a.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,n),o.exports}(()=>{"use strict";n(930);class t{static cardsUrl="https://64901aaa1e6aa71680ca93bb.mockapi.io/cards";static getCards(){return fetch(t.cardsUrl).then((t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()})).catch((t=>{throw t}))}static getWomenCards(){return fetch(t.cardsUrl).then((t=>t.json())).then((t=>{let e=[];return t.forEach((t=>{"women"===t.chapter&&e.push(t)})),e})).catch((t=>{throw t}))}static getMenCards(){return fetch(t.cardsUrl).then((t=>t.json())).then((t=>{let e=[];return t.forEach((t=>{"men"===t.chapter&&e.push(t)})),e})).catch((t=>{throw t}))}static getSelectiveCards(){return fetch(t.cardsUrl).then((t=>t.json())).then((t=>{let e=[];return t.forEach((t=>{"selective"===t.chapter&&e.push(t)})),e})).catch((t=>{throw t}))}}const e=document.querySelector(".basket-modal"),s=document.querySelector(".basket"),a=document.querySelector(".submenu__basket"),o=document.querySelector(".submenu");function r(){"block"===o.style.display&&(o.style.display,console.log(o.style.display)),e.classList.contains("basket-modal_active")?(console.log("!active"),e.classList.remove("basket-modal_active"),d()):(e.classList.add("basket-modal_active"),d())}function c(){e.classList.remove("basket-modal_active"),d()}function i(t){e.contains(t.target)||s.contains(t.target)||t.target.classList.contains("cross")||t.target.classList.contains("basket-item-minus")||a.contains(t.target)||(e.classList.remove("basket-modal_active"),d())}function d(){const t=document.querySelector(".basket-modal .basket-modal__items"),n=document.querySelector(".basket-modal__footer");e.classList.contains("basket-modal_active")?document.addEventListener("click",i):(document.removeEventListener("click",i),t.innerHTML=null,n.innerHTML=null)}s.addEventListener("click",r),a.addEventListener("click",r);const l="basket",u="User";let m=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});const p=["Минск","Витебск","Брест","Гродно","Гомель","Могилев"];function g(t,e,n){const s=document.querySelector(".alert"),a=document.createElement("div");a.classList.add("alert__wrapper",`alert__wrapper_${t}`);const o=document.createElement("span");o.textContent=`${n} ${e}`;const r=document.createElement("span");r.classList.add("alert__line"),r.style.width="0",a.append(o,r),s.append(a),setTimeout((()=>r.style.width="100%"),100),setTimeout((()=>a.remove()),3e3)}class b{static error(t){g("error",t,"❌")}static warning(t){g("warning",t,"⚠️")}static success(t){g("success",t,"✅")}}class h{static setCardToStore(t){localStorage.setItem(l,JSON.stringify(t))}static getBasketStore(){return localStorage.getItem(l)}static basketStoreData(){const t=this.getBasketStore();return JSON.parse(t)||[]}}class _{static countElementsInBasket(){const t=h.basketStoreData();let e=0;return t.forEach((t=>{e+=Number(t.quantity)})),e}static changeBasketCount(){document.querySelector(".basket__count span").textContent=this.countElementsInBasket()}}class y{static setUserToken(t){return sessionStorage.setItem(u,t)}static getUserToken(){return sessionStorage.getItem(u)}static removeUserToken(){return sessionStorage.removeItem(u)}}function k(){y.getUserToken()?(b.success("Заказ успешно создан"),h.setCardToStore([]),c(),_.changeBasketCount()):b.warning("Авторизуйтесь, чтобы сделать заказ")}const f=document.querySelector(".basket-modal");document.addEventListener("DOMContentLoaded",(function(){f.append(function(){const t=document.createElement("div");t.classList.add("modal-header");const e=document.createElement("div");e.classList.add("modal-header__heading");const n=document.createElement("h3");n.textContent="Корзина";const s=document.createElement("button");return s.classList.add("cross"),s.type="button",s.addEventListener("click",c),e.append(n),t.append(e,s),t}(),function(){const t=document.createElement("div");return t.classList.add("basket-modal__items"),t.addEventListener("click",M),t}(),function(){const t=document.createElement("div");return t.classList.add("basket-modal__footer"),t}())}));const L=document.querySelector(".basket"),v=document.querySelector(".basket-modal"),w=document.querySelector(".submenu__basket");let E;function S(){const t=h.basketStoreData();let e=0;return t.forEach((t=>e+=+t.price)),e}function q(){document.querySelector(".basket-modal__general-price span").textContent=`Итого: ${m.format(S())}`}function C(){const t=h.basketStoreData(),e=document.querySelector(".basket-modal .basket-modal__items"),n=document.querySelector(".basket-modal__footer"),s=S();v.classList.contains("basket-modal_active")&&(console.log("ифы"),t.forEach((t=>e.append(function(t){const e=document.createElement("div");return e.classList.add("basket-item"),e.id=t.id,e.append(function(t){const e=document.createElement("div");e.classList.add("basket-item__title");const n=document.createElement("h5");return n.textContent=`${t.title}`,e.append(n),n}(t),function(t){const e=document.createElement("div");e.classList.add("basket-item__count");const n=document.createElement("button");n.type="button",n.classList.add("basket-item-minus"),n.textContent="-";const s=document.createElement("span");s.classList.add("basket-item-quantity"),s.textContent=t.quantity;const a=document.createElement("button");return a.type="button",a.classList.add("basket-item-plus"),a.textContent="+",a.addEventListener("click",x),n.addEventListener("click",x),e.append(n,s,a),e}(t),function(t){const e=document.createElement("div");e.classList.add("basket-item__price");const n=document.createElement("span");return n.textContent=`${m.format(t.price)}`,e.append(n),e}(t),function(){const t=document.createElement("button");return t.classList.add("cross","cross_small"),t}()),e}(t)))),n.append(function(){const t=document.createElement("div");t.classList.add("basket-modal__buttons");const e=document.createElement("button");e.classList.add("basket-modal__delite-all"),e.type="button",e.textContent="Очистить корзину",e.addEventListener("click",D);const n=document.createElement("button");return n.classList.add("btn","basket-modal__order"),n.type="button",n.textContent="Заказать",n.addEventListener("click",k),t.append(e,n),t}(),function(t){const e=document.createElement("div");e.classList.add("basket-modal__general-price");const n=document.createElement("span");return n.textContent=`Итого: ${m.format(t)}`,e.append(n),e}(s)),O())}function x(t){const e=t.target.parentNode.parentNode,n=e.querySelector(".basket-item__price"),s=h.basketStoreData(),a=s.find((t=>t.id===e.id)),o=E.find((t=>t.id===e.id));let r=s;a&&(t.target.classList.contains("basket-item-minus")?1===Number(a.quantity)?(r=s.filter((t=>t.id!==a.id)),e.remove(),0===r.length&&O()):(T(a,o,"-"),U(t.target,a,n)):(T(a,o,"+"),U(t.target,a,n))),h.setCardToStore(r),q(),_.changeBasketCount()}function U(t,e,n){(t.classList.contains("basket-item-minus")?t.nextElementSibling:t.previousElementSibling).textContent=e.quantity,n.textContent=`${m.format(e.price)}`}function T(t,e,n){let s="-"===n;return t.quantity=(s?Number(t.quantity)-1:Number(t.quantity)+1).toString(),t.price=(s?Number(t.price)-Number(e.price):Number(t.price)+Number(e.price)).toString(),t.quantity&&t.price}function N(t){const e=h.basketStoreData(),n=t.target.parentNode.parentNode.parentNode.id;let s=[];const a=E.find((t=>t.id===n));if(e){s=e;const t=s.find((t=>t.id===n));t?T(t,a,"+"):s.push(a)}else s.push(a);h.setCardToStore(s),_.changeBasketCount(),b.success("Товар добавлен в корзину")}function M(t){const e=t.target.parentNode,n=h.basketStoreData().filter((t=>e.id!==t.id));h.setCardToStore(n),t.target.classList.contains("cross")&&(e.remove(),O(),q(),_.changeBasketCount())}function D(){document.querySelector(".basket-modal .basket-modal__items").textContent="Корзина пуста",h.setCardToStore([]),O(),_.changeBasketCount()}function O(){const t=document.querySelector(".basket-modal__footer"),e=document.querySelector(".basket-modal .basket-modal__items");document.querySelector(".basket-item")?t.style.display="flex":(t.style.display="none",e.textContent="Корзина пуста")}document.addEventListener("DOMContentLoaded",(function(){!async function(){E=await t.getCards()}(),L.addEventListener("click",C),!document.querySelector(".basket__count")&&L.append(function(){console.log("count");const t=document.createElement("div");t.classList.add("basket__count");const e=document.createElement("span");return e.textContent=_.countElementsInBasket(),t.append(e),t}()),w.addEventListener("click",C),setTimeout((()=>(()=>{const t=document.querySelectorAll(".card-btn");t&&t.forEach((t=>t.addEventListener("click",N)))})()),1e3)}));const I=[{tag:"input",class:"registration__input",id:"city",attributes:[{type:"text"},{placeholder:"Город"},{list:"city-list"},{autocomplete:"address-level2"},{"data-input":"city"}]},{tag:"datalist",id:"city-list"},{tag:"span",class:["error-message"],id:"error-city",attributes:[{"data-error":"city"}]},{tag:"input",class:"registration__input",attributes:[{type:"text"},{placeholder:"Имя"},{autocomplete:"given-name"},{"data-input":"name"}]},{tag:"span",class:["error-message"],id:"error-name",attributes:[{"data-error":"name"}]},{tag:"input",id:"birthday",class:"registration__input",attributes:[{type:"date"},{placeholder:"Дата рождения"},{autocomplete:"bday"},{name:"trip-start"},{min:"1900-01-01"},{"data-input":"date"}]},{tag:"span",class:["error-message"],id:"error-date",attributes:[{"data-error":"date"}]},{tag:"input",class:"registration__input",attributes:[{type:"email"},{placeholder:"Почта"},{autocomplete:"email"},{"data-input":"email"}]},{tag:"span",class:["error-message"],id:"error-email",attributes:[{"data-error":"email"}]},{tag:"input",class:"registration__input",attributes:[{type:"password"},{placeholder:"Пароль"},{autocomplete:"current-password"},{"data-input":"password-1"}]},{tag:"button",class:"btn-show-password",attributes:[{"data-password":"password-1"},{type:"button"}],content:"👁"},{tag:"span",id:"error-password",class:["error-message"],attributes:[{"data-error":"password-1"}]},{tag:"input",class:"registration__input",attributes:[{type:"password"},{placeholder:"Введите пароль еще раз"},{autocomplete:"current-password"},{"data-input":"password-2"}]},{tag:"button",class:"btn-show-password",attributes:[{"data-password":"password-2"},{type:"button"}],content:"👁"},{tag:"span",class:["error-message"],attributes:[{"data-error":"password-2"}]},{tag:"input",id:"registration__checkbox",class:["registration__input","registration__checkbox"],attributes:[{type:"checkbox"},{"data-input":"checkbox"}]},{tag:"a",class:["registration__label"],content:"Согласен с политикой конфиденциальности"},{tag:"span",class:["error-message"],attributes:[{"data-error":"checkbox"}]},{tag:"button",class:["btn","registration__button"],content:"Зарегистрироваться",attributes:[{type:"submit"}]}];class A{static passwordDossNotMatch="Пароль не совпадает";static passwordIncorrectLength="Пароль должен содержать не менее 6 символов и одну заглавную букву";static chooseAnotherCity="Выберите другой город";static whiteSpace="Строки не должны содержать пробелы";static invalidEmail="Неправильно введенный e-mail";static errorMessageMaxQuantity(t,e,n){t.textContent=`Имя не должно содержать ${n}\nМаксимальное кол-во ${e} символов`}static errorMessageExistingLogin(t,e){t.textContent=`Пользователь ${e} уже существует`}static setErrorMessage(t,e){t.textContent=e}}class ${static userUrl="https://64901aaa1e6aa71680ca93bb.mockapi.io/user";static setUserData(t,e,n,s,a,o,r){return new Promise(((c,i)=>{fetch(this.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:e,token:n,city:s,name:a,date:o,orders:r})}).then((t=>{t.ok?c():i()})).catch((t=>{throw t}))}))}static async changeUserOrders(t,e){const n=await this.getUserToken(t),s=n.id;return n.orders=e,fetch(`${this.userUrl}/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((t=>{if(t.ok)return t.json();throw new Error("Failed to change user data")})).catch((t=>{throw t}))}static getUserData(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>e.login===t)))).catch((t=>{throw t}))}static getUserLogin(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>e.login===t)))).catch((t=>{throw t}))}static getUserToken(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>e.token.toString()===t)))).catch((t=>{throw t}))}}class B{static specialSymbolsArray=/[!@#$%^&*()[\]{}|\\;:'"<>.,\/?`~=+\-№_]/;static specialSymbols="!@#$%^&*()-_+={}[]|\\;:'\"<>.,/?`~№";static maxNumberOfLettersName=20;static maxNumberOfLettersEmail=40;static minNumberOfLettersPasswords=6;static token=Math.random()*new Date;static successRegistration="Регистрация прошла успешно"}class j{static signOut="Выйти из акаунта";static signIn="Войти";static welcomeUser=t=>`Добро пожаловать, ${t}`;static welcome="Добро пожаловать!"}function H(){const t=y.getUserToken();document.querySelector(".authentication__sign-up").style.display=t?"none":"block"}H();const Y=document.querySelector(".user"),P=document.querySelector(".submenu__user"),F=document.querySelector(".user__modal");function J(){F.classList.contains("user__modal_active")?F.classList.remove("user__modal_active"):F.classList.add("user__modal_active"),R()}function Q(){F.classList.remove("user__modal_active"),R()}function R(){F.classList.contains("user__modal_active")?document.addEventListener("click",V):document.removeEventListener("click",V)}function V(t){!F.contains(t.target)&&!Y.contains(t.target)&&!P.contains(t.target)&&F.classList.remove("user__modal_active"),!F.classList.contains("user__modal_active")&&document.removeEventListener("click",V)}async function W(){F.innerHTML=null;const t=y.getUserToken(),e=await $.getUserToken(t);t?X(j.welcomeUser(e.name),j.signOut):X(j.welcome,j.signIn)}function X(t,e){F.append(function(t){const e=document.createElement("div");e.classList.add("modal-header");const n=document.createElement("div");n.classList.add("modal-header__heading");const s=document.createElement("h5");s.textContent=t;const a=document.createElement("button");return a.classList.add("cross"),a.type="button",a.addEventListener("click",Q),n.append(s),e.append(n,a),e}(t),function(t=j.signOut){const e=document.createElement("button");return e.classList.add("btn","user__btn-exit"),e.textContent=t,e.addEventListener("click",Z),e}(e))}async function Z(){const t=y.getUserToken(),e=h.basketStoreData(),n=await $.getUserToken(t);t?($.changeUserOrders(n.token.toString(),e),H(),setTimeout((()=>(y.removeUserToken(),h.setCardToStore([]),void location.reload())),1e3)):(document.getElementById("authentication").scrollIntoView({behavior:"smooth"}),F.classList.remove("user__modal_active"))}Y.addEventListener("click",J),P.addEventListener("click",J),document.addEventListener("DOMContentLoaded",W);const z=document.querySelector(".registration");function G(){const t=document.createElement("div");t.classList.add("registration__wrapper"),t.append(function(){const t=document.createElement("div");return t.classList.add("registration__image-inner"),t}(),function(){const t=document.createElement("form");return t.classList.add("registration__form"),function(t){I.forEach((e=>{const n=document.createElement(e.tag);var s;if(Array.isArray(e.class)&&e.class.length>0?e.class.forEach((t=>n.classList.add(t))):e.class&&n.classList.add(e.class),e.attributes&&e.attributes.length>0&&e.attributes.forEach((t=>{const[e,s]=Object.entries(t)[0];n.setAttribute(e,s)})),e.id&&"city-list"===e.id?(n.id=e.id,s=n,p.forEach((t=>{const e=document.createElement("option");e.textContent=t,s.appendChild(e)}))):e.id&&(n.id=e.id),"date"===n.getAttribute("type")){n.addEventListener("keydown",(function(t){t.preventDefault()}));let t=new Date;t.setFullYear(t.getFullYear()-18),n.setAttribute("max",t.toISOString().split("T")[0])}e.content&&(n.textContent=e.content),t.append(n)}))}(t),t}()),z.append(t),t.querySelector(".registration__label").addEventListener("click",tt),document.querySelector(".registration__button").addEventListener("click",K)}function K(t){t.preventDefault(),async function(){document.querySelectorAll(".error-message").forEach((t=>t.textContent=null));const t=Array.from(document.querySelectorAll(".registration__input"));let e=t.map((t=>t.value));const[n,s,a,o,r,c]=e,i=document.getElementById("error-city"),d=document.getElementById("error-name"),l=document.getElementById("error-email"),u=document.querySelector('[data-error="password-1"]'),m=await $.getUserLogin(o),g=h.basketStoreData();et(t).includes(!1)?et(t):p.includes(n)?s.includes(" ")?A.setErrorMessage(d,A.whiteSpace):o.includes(" ")?A.setErrorMessage(l,A.whiteSpace):r.includes(" ")?A.setErrorMessage(u,A.whiteSpace):s.length>B.maxNumberOfLettersName||s.match(B.specialSymbolsArray)?A.errorMessageMaxQuantity(d,B.maxNumberOfLettersName,B.specialSymbols):/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(o)?o.length>B.maxNumberOfLettersEmail?A.errorMessageMaxQuantity(l,B.maxNumberOfLettersEmail):m?A.errorMessageExistingLogin(l,o):r!==c?A.setErrorMessage(u,A.passwordDossNotMatch):r.length<B.minNumberOfLettersPasswords||!r.match(/[A-ZА-Я]/i)?A.setErrorMessage(u,A.passwordIncorrectLength):($.setUserData(o,r,B.token,n,s,a,g),b.success(B.successRegistration),y.setUserToken(B.token),H(),setTimeout((()=>{W(),location.reload()}),4e3)):A.setErrorMessage(l,A.invalidEmail):A.setErrorMessage(i,A.chooseAnotherCity)}()}function tt(){const t=document.querySelector(".registration__label");window.location.href,t.href="./privacy-policy.html"}document.querySelector(".authentication__sign-up").addEventListener("click",(function(){const t="registration_active";z.classList.contains(t)?z.classList.remove(t):z.classList.add(t)}));const et=t=>{let e=[];return t.forEach((t=>{let n=t.getAttribute("data-input"),s=document.querySelector(`[data-error="${n}"]`);"checkbox"!==n||t.checked?""===t.value?(s.textContent="Поле должно быть заполнено",e.push(!1)):e.push(!0):(s.textContent="Подтвердите согласие",e.push(!1))})),e};document.addEventListener("DOMContentLoaded",(function(){G(),function(){const t=document.querySelector('[data-input="password-1"]'),e=document.querySelector('[data-input="password-2"]'),n=document.querySelector('[data-password="password-1"]'),s=document.querySelector('[data-password="password-2"]');document.querySelectorAll("[data-password]").forEach((a=>{a.addEventListener("click",(function(a){const o="btn-show-password_show";let r="password-1"===a.target.getAttribute("data-password"),c=r?t:e;c.type="password"===c.type?"text":"password";let i=r?n:s;i.classList.contains(o)?i.classList.remove(o):i.classList.add(o)}))}))}()}));const nt=document.querySelector(".signIn__input-login"),st=document.querySelector(".signIn__inputp-password"),at=document.querySelector(".authentication .form .btn"),ot=document.querySelector(".authentication .form");function rt(){const t=document.querySelector('[data-error-log="login"]'),e=document.querySelector('[data-error-log="password"]');t.textContent=null,e.textContent=null}function ct(t){t.preventDefault(),async function(){rt();const t=await $.getUserData(nt.value),e=document.querySelector('[data-error-log="login"]'),n=document.querySelector('[data-error-log="password"]');y.getUserToken()?b.error("Выйдите из аккаунта"):t?t.password!==st.value?n.textContent="Неверный пароль":(b.success("Вы вошли в аккаунт"),H(),y.setUserToken(t.token),W(),ot.reset(),rt(),h.setCardToStore(t.orders),_.changeBasketCount()):e.textContent="Пользователь не зарегистрирован"}()}document.addEventListener("DOMContentLoaded",(function(){at.addEventListener("click",ct),function(){const t=document.querySelector('[data-password-log="password"]'),e="btn-show-password_show";t.addEventListener("click",(()=>{st.type="password"===st.type?"text":"password",t.classList.contains(e)?t.classList.remove(e):t.classList.add(e)}))}()})),n(516),n(693)})()})();