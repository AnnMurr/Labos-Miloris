(()=>{"use strict";var t={657:(t,e,s)=>{s.d(e,{$:()=>r});class r{static userUrl="https://64901aaa1e6aa71680ca93bb.mockapi.io/user";static setUserData(t,e,s,r,a,n,o){return new Promise(((c,i)=>{fetch(this.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:e,token:s,city:r,name:a,date:n,orders:o})}).then((t=>{t.ok?c():i()})).catch((t=>{throw t}))}))}static async changeUserOrders(t,e){const s=await this.getUserToken(t),r=s.id;return s.orders=e,fetch(`${this.userUrl}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((t=>{if(t.ok)return t.json();throw new Error("Failed to change user data")})).catch((t=>{throw t}))}static getUserData(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>e.login===t)))).catch((t=>{throw t}))}static getUserLogin(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>e.login===t)))).catch((t=>{throw t}))}static getUserToken(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>e.token.toString()===t)))).catch((t=>{throw t}))}}},64:(t,e,s)=>{s.d(e,{G$:()=>a,MX:()=>n,e0:()=>r});const r="basket",a="User";new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});const n=["–ú–∏–Ω—Å–∫","–í–∏—Ç–µ–±—Å–∫","–ë—Ä–µ—Å—Ç","–ì—Ä–æ–¥–Ω–æ","–ì–æ–º–µ–ª—å","–ú–æ–≥–∏–ª–µ–≤"]},695:(t,e,s)=>{function r(t,e,s){const r=document.querySelector(".alert"),a=document.createElement("div");a.classList.add("alert__wrapper",`alert__wrapper_${t}`);const n=document.createElement("span");n.textContent=`${s} ${e}`;const o=document.createElement("span");o.classList.add("alert__line"),o.style.width="0",a.append(n,o),r.append(a),setTimeout((()=>o.style.width="100%"),100),setTimeout((()=>a.remove()),3e3)}s.d(e,{c:()=>a});class a{static error(t){r("error",t,"‚ùå")}static warning(t){r("warning",t,"‚ö†Ô∏è")}static success(t){r("success",t,"‚úÖ")}}},324:(t,e,s)=>{s.d(e,{C:()=>a});var r=s(780);function a(){const t=r.U.getUserToken();document.querySelector(".authentication__sign-up").style.display=t?"none":"block"}a()},459:(t,e,s)=>{s.d(e,{a:()=>p});var r=s(780);class a{static signOut="–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∞—É–Ω—Ç–∞";static signIn="–í–æ–π—Ç–∏";static welcomeUser=t=>`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${t}`;static welcome="–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!"}var n=s(657),o=s(565),c=s(324);const i=document.querySelector(".user"),d=document.querySelector(".user__modal");function l(){d.classList.remove("user__modal_active"),u()}function u(){d.classList.contains("user__modal_active")?document.addEventListener("click",m):document.removeEventListener("click",m)}function m(t){!d.contains(t.target)&&!i.contains(t.target)&&d.classList.remove("user__modal_active"),!d.classList.contains("user__modal_active")&&document.removeEventListener("click",m)}async function p(){d.innerHTML=null;const t=r.U.getUserToken(),e=await n.$.getUserToken(t);t?g(a.welcomeUser(e.name),a.signOut):g(a.welcome,a.signIn)}function g(t,e){d.append(function(t){const e=document.createElement("div");e.classList.add("modal-header");const s=document.createElement("div");s.classList.add("modal-header__heading");const r=document.createElement("h5");r.textContent=t;const a=document.createElement("button");return a.classList.add("cross"),a.type="button",a.addEventListener("click",l),s.append(r),e.append(s,a),e}(t),function(t=a.signOut){const e=document.createElement("button");return e.classList.add("btn","user__btn-exit"),e.textContent=t,e.addEventListener("click",h),e}(e))}async function h(){const t=r.U.getUserToken(),e=o.h.basketStoreData(),s=await n.$.getUserToken(t);t?(n.$.changeUserOrders(s.token.toString(),e),(0,c.C)(),setTimeout((()=>(r.U.removeUserToken(),o.h.setCardToStore([]),void location.reload())),1e3)):(document.getElementById("authentication").scrollIntoView({behavior:"smooth"}),d.classList.remove("user__modal_active"))}i.addEventListener("click",(function(){d.classList.toggle("user__modal_active"),u()})),document.addEventListener("DOMContentLoaded",p)},565:(t,e,s)=>{s.d(e,{h:()=>a});var r=s(64);class a{static setCardToStore(t){localStorage.setItem(r.e0,JSON.stringify(t))}static getBasketStore(){return localStorage.getItem(r.e0)}static basketStoreData(){const t=this.getBasketStore();return JSON.parse(t)||[]}}},780:(t,e,s)=>{s.d(e,{U:()=>a});var r=s(64);class a{static setUserToken(t){return sessionStorage.setItem(r.G$,t)}static getUserToken(){return sessionStorage.getItem(r.G$)}static removeUserToken(){return sessionStorage.removeItem(r.G$)}}}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,s),n.exports}s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=s(64);const e=[{tag:"input",class:"registration__input",id:"city",attributes:[{type:"text"},{placeholder:"–ì–æ—Ä–æ–¥"},{list:"city-list"},{autocomplete:"address-level2"},{"data-input":"city"}]},{tag:"datalist",id:"city-list"},{tag:"span",class:["error-message"],id:"error-city",attributes:[{"data-error":"city"}]},{tag:"input",class:"registration__input",attributes:[{type:"text"},{placeholder:"–ò–º—è"},{autocomplete:"given-name"},{"data-input":"name"}]},{tag:"span",class:["error-message"],id:"error-name",attributes:[{"data-error":"name"}]},{tag:"input",id:"birthday",class:"registration__input",attributes:[{type:"date"},{placeholder:"–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è"},{autocomplete:"bday"},{name:"trip-start"},{min:"1900-01-01"},{"data-input":"date"}]},{tag:"span",class:["error-message"],id:"error-date",attributes:[{"data-error":"date"}]},{tag:"input",class:"registration__input",attributes:[{type:"email"},{placeholder:"–ü–æ—á—Ç–∞"},{autocomplete:"email"},{"data-input":"email"}]},{tag:"span",class:["error-message"],id:"error-email",attributes:[{"data-error":"email"}]},{tag:"input",class:"registration__input",attributes:[{type:"password"},{placeholder:"–ü–∞—Ä–æ–ª—å"},{autocomplete:"current-password"},{"data-input":"password-1"}]},{tag:"button",class:"btn-show-password",attributes:[{"data-password":"password-1"},{type:"button"}],content:"üëÅ"},{tag:"span",id:"error-password",class:["error-message"],attributes:[{"data-error":"password-1"}]},{tag:"input",class:"registration__input",attributes:[{type:"password"},{placeholder:"–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –µ—â–µ —Ä–∞–∑"},{autocomplete:"current-password"},{"data-input":"password-2"}]},{tag:"button",class:"btn-show-password",attributes:[{"data-password":"password-2"},{type:"button"}],content:"üëÅ"},{tag:"span",class:["error-message"],attributes:[{"data-error":"password-2"}]},{tag:"input",id:"registration__checkbox",class:["registration__input","registration__checkbox"],attributes:[{type:"checkbox"},{"data-input":"checkbox"}]},{tag:"a",class:["registration__label"],content:"–°–æ–≥–ª–∞—Å–µ–Ω —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏"},{tag:"span",class:["error-message"],attributes:[{"data-error":"checkbox"}]},{tag:"button",class:["btn","registration__button"],content:"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è",attributes:[{type:"submit"}]}];class r{static passwordDossNotMatch="–ü–∞—Ä–æ–ª—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç";static passwordIncorrectLength="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤ –∏ –æ–¥–Ω—É –∑–∞–≥–ª–∞–≤–Ω—É—é –±—É–∫–≤—É";static chooseAnotherCity="–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥";static whiteSpace="–°—Ç—Ä–æ–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã";static invalidEmail="–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≤–µ–¥–µ–Ω–Ω—ã–π e-mail";static errorMessageMaxQuantity(t,e,s){t.textContent=`–ò–º—è –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å ${s}\n–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ ${e} —Å–∏–º–≤–æ–ª–æ–≤`}static errorMessageExistingLogin(t,e){t.textContent=`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${e} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç`}static setErrorMessage(t,e){t.textContent=e}}var a=s(657);class n{static specialSymbolsArray=/[!@#$%^&*()[\]{}|\\;:'"<>.,\/?`~=+\-‚Ññ_]/;static specialSymbols="!@#$%^&*()-_+={}[]|\\;:'\"<>.,/?`~‚Ññ";static maxNumberOfLettersName=20;static maxNumberOfLettersEmail=40;static minNumberOfLettersPasswords=6;static token=Math.random()*new Date;static successRegistration="–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ"}var o=s(695),c=s(780),i=s(459),d=s(565),l=s(324);const u=document.querySelector(".registration");function m(){const s=document.createElement("div");s.classList.add("registration__wrapper"),s.append(function(){const t=document.createElement("div");return t.classList.add("registration__image-inner"),t}(),function(){const s=document.createElement("form");return s.classList.add("registration__form"),function(s){e.forEach((e=>{const r=document.createElement(e.tag);var a;if(Array.isArray(e.class)&&e.class.length>0?e.class.forEach((t=>r.classList.add(t))):e.class&&r.classList.add(e.class),e.attributes&&e.attributes.length>0&&e.attributes.forEach((t=>{const[e,s]=Object.entries(t)[0];r.setAttribute(e,s)})),e.id&&"city-list"===e.id?(r.id=e.id,a=r,t.MX.forEach((t=>{const e=document.createElement("option");e.textContent=t,a.appendChild(e)}))):e.id&&(r.id=e.id),"date"===r.getAttribute("type")){r.addEventListener("keydown",(function(t){t.preventDefault()}));let t=new Date;t.setFullYear(t.getFullYear()-18),r.setAttribute("max",t.toISOString().split("T")[0])}e.content&&(r.textContent=e.content),s.append(r)}))}(s),s}()),u.append(s),s.querySelector(".registration__label").addEventListener("click",g),document.querySelector(".registration__button").addEventListener("click",p)}function p(e){e.preventDefault(),async function(){document.querySelectorAll(".error-message").forEach((t=>t.textContent=null));const e=Array.from(document.querySelectorAll(".registration__input"));let s=e.map((t=>t.value));const[u,m,p,g,y,w]=s,b=document.getElementById("error-city"),_=document.getElementById("error-name"),f=document.getElementById("error-email"),v=document.querySelector('[data-error="password-1"]'),S=await a.$.getUserLogin(g),L=d.h.basketStoreData();h(e).includes(!1)?h(e):t.MX.includes(u)?m.includes(" ")?r.setErrorMessage(_,r.whiteSpace):g.includes(" ")?r.setErrorMessage(f,r.whiteSpace):y.includes(" ")?r.setErrorMessage(v,r.whiteSpace):m.length>n.maxNumberOfLettersName||m.match(n.specialSymbolsArray)?r.errorMessageMaxQuantity(_,n.maxNumberOfLettersName,n.specialSymbols):/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(g)?g.length>n.maxNumberOfLettersEmail?r.errorMessageMaxQuantity(f,n.maxNumberOfLettersEmail):S?r.errorMessageExistingLogin(f,g):y!==w?r.setErrorMessage(v,r.passwordDossNotMatch):y.length<n.minNumberOfLettersPasswords||!y.match(/[A-Z–ê-–Ø]/i)?r.setErrorMessage(v,r.passwordIncorrectLength):(a.$.setUserData(g,y,n.token,u,m,p,L),o.c.success(n.successRegistration),c.U.setUserToken(n.token),(0,l.C)(),setTimeout((()=>{(0,i.a)(),location.reload()}),4e3)):r.setErrorMessage(f,r.invalidEmail):r.setErrorMessage(b,r.chooseAnotherCity)}()}function g(){const t=document.querySelector(".registration__label");window.location.href,t.href="./privacy-policy.html"}document.querySelector(".authentication__sign-up").addEventListener("click",(function(){const t="registration_active";u.classList.contains(t)?u.classList.remove(t):u.classList.add(t)}));const h=t=>{let e=[];return t.forEach((t=>{let s=t.getAttribute("data-input"),r=document.querySelector(`[data-error="${s}"]`);"checkbox"!==s||t.checked?""===t.value?(r.textContent="–ü–æ–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–æ",e.push(!1)):e.push(!0):(r.textContent="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ–≥–ª–∞—Å–∏–µ",e.push(!1))})),e};document.addEventListener("DOMContentLoaded",(function(){m(),function(){const t=document.querySelector('[data-input="password-1"]'),e=document.querySelector('[data-input="password-2"]'),s=document.querySelector('[data-password="password-1"]'),r=document.querySelector('[data-password="password-2"]');document.querySelectorAll(".btn-show-password").forEach((a=>{a.addEventListener("click",(function(a){const n="btn-show-password_show";let o="password-1"===a.target.getAttribute("data-password"),c=o?t:e;c.type="password"===c.type?"text":"password";let i=o?s:r;i.classList.contains(n)?i.classList.remove(n):i.classList.add(n)}))}))}()}));const y=document.querySelector(".signIn__input-login"),w=document.querySelector(".signIn__inputp-password"),b=document.querySelector(".authentication .form .btn"),_=document.querySelector(".authentication .form");function f(){const t=document.querySelector('[data-error-log="login"]'),e=document.querySelector('[data-error-log="password"]');t.textContent=null,e.textContent=null}function v(t){t.preventDefault(),async function(){f();const t=await a.$.getUserData(y.value),e=document.querySelector('[data-error-log="login"]'),s=document.querySelector('[data-error-log="password"]');c.U.getUserToken()?o.c.error("–í—ã–π–¥–∏—Ç–µ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞"):t?t.password!==w.value?s.textContent="–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å":(o.c.success("–í—ã –≤–æ—à–ª–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç"),(0,l.C)(),c.U.setUserToken(t.token),(0,i.a)(),_.reset(),f(),d.h.setCardToStore(t.orders)):e.textContent="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"}()}document.addEventListener("DOMContentLoaded",(function(){b.addEventListener("click",v),document.querySelector('[data-password-log="password"]').addEventListener("click",(()=>w.type="password"===w.type?"text":"password"))}))})()})();